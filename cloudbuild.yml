steps:
- id: "Build WAR files using Maven"
  name: maven
  entrypoint: /bin/bash
  args:
    - -c
    - |
      # Going to workspace where code is present
      echo Hello
      chmod +x build_script.sh
      ./build_script.sh
      echo *************root**********************
      ls
      echo *************springboot-cont-a folder**********************
      ls ../springboot-cont-a
      echo *************springboot-cont-a/target folder**********************
      ls ../springboot-cont-a/target
      echo *************workspace folder**********************
      ls /workspace
- id: "Building docker image for container a"
  name: 'gcr.io/cloud-builders/docker'
  args: [ 'build', '-t',
          'us-west1-docker.pkg.dev/project-for-tf-cicd-kube/my-docker-repository/img-a:v1',
          '-f', '/workspace/Tomcat-working/DockerfileContA', '/workspace/Tomcat-working/' ]
- id: "Building docker image for container b"
  name: 'gcr.io/cloud-builders/docker'
  args: [ 'build', '-t',
          'us-west1-docker.pkg.dev/project-for-tf-cicd-kube/my-docker-repository/img-b:v1',
          '-f', '/workspace/Tomcat-working/DockerfileContB', '/workspace/Tomcat-working/' ]
- id: "Building docker image for container c"
  name: 'gcr.io/cloud-builders/docker'
  args: [ 'build', '-t',
          'us-west1-docker.pkg.dev/project-for-tf-cicd-kube/my-docker-repository/img-c:v1',
          '-f', '/workspace/Tomcat-working/DockerfileContC', '/workspace/Tomcat-working/' ]
- id: "Building docker image for container d"
  name: 'gcr.io/cloud-builders/docker'
  args: [ 'build', '-t',
          'us-west1-docker.pkg.dev/project-for-tf-cicd-kube/my-docker-repository/img-d:v1',
          '-f', '/workspace/Tomcat-working/DockerfileContD', '/workspace/Tomcat-working/' ]
images:
- 'us-west1-docker.pkg.dev/project-for-tf-cicd-kube/my-docker-repository/img-a:v1'
- 'us-west1-docker.pkg.dev/project-for-tf-cicd-kube/my-docker-repository/img-b:v1'
- 'us-west1-docker.pkg.dev/project-for-tf-cicd-kube/my-docker-repository/img-c:v1'
- 'us-west1-docker.pkg.dev/project-for-tf-cicd-kube/my-docker-repository/img-d:v1'
# artifacts:
#   objects:
#     location: 'gs://war-file-bucket/$PROJECT_ID'
#     paths: ['/workspace/*.war']
options:
  logging: CLOUD_LOGGING_ONLY
